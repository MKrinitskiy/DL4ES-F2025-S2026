# Домашнее задание №3  
**Курс:** Deep Learning for Earth Sciences (DL4ES), 2025  
**Тема:** Гистограммы скрытых представлений в TensorBoard  
**Дедлайн:** **09.12.2025 (включительно)**

---

## 1. Цель работы
Закрепить навыки мониторинга обучения нейросетей и работы с TensorBoard, а также научиться извлекать и анализировать скрытые представления (hidden representations) внутри модели.

---

## 2. Задание
В ноутбуке *PyTorch for Neural Networks* (который был выдан на лекции) необходимо:

### 2.1. Определить, что считать скрытым представлением
Студент **сам выбирает**, что считать hidden representation в данной модели:

- только линейные выходы слоёв `Z` (до активации),  
- только активации `H` (после функции активации),  
- либо **оба варианта**.

Необходимо **явно указать словами в ноутбуке**, что именно было выбрано.

---

## 3. Что требуется реализовать

### 3.1. Модифицировать модель
Сделать так, чтобы модель возвращала промежуточные значения скрытых представлений для каждого слоя.

Разрешённые способы:
1. **Ручное объявление всех промежуточных вычислений** внутри `forward()`.
2. **Использование PyTorch hooks**:  
   ```python
   layer.register_forward_hook(...)
   ```

Оба подхода допустимы.

---

### 3.2. Логирование скрытых представлений в TensorBoard
В цикле обучения для каждой эпохи необходимо добавить:

```python
writer.add_histogram("hidden/<layer_name>", tensor.data.cpu().numpy(), global_step)
```

Должны логироваться гистограммы **каждого слоя модели**.

---

## 4. Формат сдачи
Студент должен предоставить:

1. **Ноутбук `.ipynb`**, который:
   - запускается без ошибок,
   - генерирует валидные TensorBoard-логи,
   - содержит словесное объяснение, что считается скрытым представлением.

---

## 5. Критерии оценки
- (30%) Корректная модификация модели и извлечение скрытых представлений.  
- (30%) Корректное логирование гистограмм каждого слоя.  
- (20%) Ясное текстовое описание выбранного определения hidden representations.  
- (20%) Отсутствие ошибок при запуске + корректная структура TensorBoard-логов.
